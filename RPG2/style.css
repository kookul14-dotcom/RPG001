@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Noto+Sans+KR:wght@400;700&display=swap');

:root {
    --gold: #ffd700;
    --panel-bg: rgba(25, 25, 30, 0.95);
    --item-bg: #151515;
    --border-dim: #333;
    --font-main: 'Noto Sans KR', sans-serif;
    --font-game: 'Orbitron', sans-serif;
}

/* =========================================
   1. GLOBAL & RESET
   ========================================= */
* { box-sizing: border-box; }
body { 
    margin: 0; padding: 0; overflow: hidden; 
    background: #050505; color: #ddd; 
    font-family: var(--font-main); user-select: none; 
}

/* =========================================
   2. CURSORS
   ========================================= */
#viewport {
    cursor: default;
    position: relative;
    overflow: hidden;
    background: #080808;
}
#viewport.cursor-attack {
    cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" filter="drop-shadow(2px 2px 2px rgba(255,0,0,0.4))"><path d="M24 4l4 4-2 2 2 2-2 2-2-2-2 2 2 2-12 12-4-4 12-12 2 2-2-2 2-2-2-2 2-2z" fill="%23ffcccc" stroke="%23800" stroke-width="1.5"/><path d="M6 26l-4 4 4-4-2-2z" fill="%23500"/></svg>') 2 28, crosshair !important;
}
#viewport.cursor-skill { cursor: crosshair !important; }
#viewport.cursor-move { cursor: grabbing !important; }

/* =========================================
   3. SCENE & LAYOUT
   ========================================= */
.scene { position: absolute; top:0; left:0; width:100vw; height:100vh; background:#111; display:none; z-index:10; }
.scene.active { display:flex; flex-direction:column; }

/* Title Scene */
#scene-title { background: linear-gradient(135deg, #0f0c29, #302b63, #24243e); align-items:center; justify-content:center; cursor:pointer; }
.game-title { font-family: var(--font-game); font-size:80px; color:gold; text-shadow:0 0 20px rgba(255,215,0,0.5); margin:0; }
.click-start { font-size:24px; color:#aaa; margin-top:20px; animation:blink 1.5s infinite; }
.sub-text { color:#666; font-size:12px; margin-top:50px; }
@keyframes blink { 50% { opacity:0.5; } }

/* Town Scene */
#scene-town { background: radial-gradient(circle at center, #222, #000); }
.town-header { height:60px; background:rgba(0,0,0,0.8); border-bottom:2px solid #444; display:flex; justify-content:space-between; align-items:center; padding:0 40px; }
.town-name { font-size:24px; font-weight:bold; color:#eba; }
.resource-display { font-size:18px; display:flex; gap:20px; font-family: var(--font-game); }
.town-content { flex:1; display:flex; align-items:center; justify-content:center; }

.town-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 30px;
    width: 90%;
    max-width: 1200px;
    margin: auto;
}

.town-btn {
    height: 180px;
    background: linear-gradient(135deg, #222, #0d0d0d);
    border: 1px dashed #555;
    border-radius: 12px;
    font-family: var(--font-game);
    transition: 0.3s all;
    position: relative;
    overflow: hidden;
    color: #eee;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}
.town-btn:hover { border: 1px solid var(--gold); transform: translateY(-10px); box-shadow: 0 15px 30px rgba(255, 215, 0, 0.15); }
.town-btn .btn-icon { font-size: 60px; margin-bottom: 15px; filter: drop-shadow(0 0 10px rgba(255,215,0,0.3)); }
.town-btn .btn-text { font-size: 20px; letter-spacing: 2px; }
.town-btn.danger { border-color:#844; color:#f88; }
.town-btn.danger:hover { background:#422; border-color:#f55; }

/* Sub Headers */
.sub-header { 
    height:60px; background: linear-gradient(90deg, #333, #111); border-bottom: 2px solid #554; 
    display:flex; justify-content:space-between; align-items:center; padding:0 30px; 
    color: var(--gold); text-shadow: 0 0 8px rgba(255, 215, 0, 0.4); font-family: var(--font-game);
}
.close-btn { 
    padding:8px 20px; background:#422; color:#f88; border:1px solid #633; cursor:pointer; 
    border-radius:4px; font-family: var(--font-game); text-transform: uppercase;
}
.close-btn:hover { background:#733; }
.sub-content { flex:1; padding:30px; overflow-y:auto; display:flex; flex-direction:column; gap:10px; align-items:center; }

/* Stage Select */
.chapter-list { padding:15px; background:#151515; display:flex; gap:10px; overflow-x:auto; width: 100%; justify-content: center; }
.chapter-btn { padding:10px 20px; background:#333; border:1px solid #555; color:#aaa; cursor:pointer; border-radius:4px; font-family: var(--font-game); }
.chapter-btn.active { background:#554; color:gold; border-color:gold; }
.stage-list { padding:30px; display:grid; grid-template-columns:repeat(auto-fill, minmax(150px, 1fr)); gap:20px; width:100%; max-width: 1000px; }

/* =========================================
   4. BATTLE UI LAYOUT
   ========================================= */
#game-frame { display:grid; grid-template-columns:260px 1fr 280px; grid-template-rows:1fr 280px; width:100%; height:100%; background:#111; }
.panel { background:#151515; border:1px solid #333; box-shadow:inset 0 0 20px rgba(0,0,0,0.8); display:flex; flex-direction:column; position:relative; overflow:hidden; }
.panel-header { background:linear-gradient(to bottom, #2a2a2a, #111); padding:6px; text-align:center; font-weight:bold; border-bottom:2px solid #444; color:#eba; font-size:13px; flex-shrink: 0; font-family: var(--font-game); }

#sidebar-left { grid-column:1; grid-row:1/3; border-right:2px solid #444; z-index:20; }
#sidebar-right { grid-column:3; grid-row:1/3; border-left:2px solid #444; z-index:20; display: flex; flex-direction: column; }
#viewport { grid-column:2; grid-row:1; }

#bottom-panel { 
    grid-column: 2; grid-row: 2; display: flex !important; flex-direction: row !important;
    overflow-x: auto; overflow-y: hidden; align-items: stretch; gap: 0; transition: opacity 0.3s ease;
}

#gridCanvas { display:block; width: 100%; height: 100%; }
#overlay-layer { position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; }
#zoom-hint { position: absolute; bottom: 10px; right: 10px; color: rgba(255,255,255,0.3); font-size: 12px; pointer-events: none; }

/* =========================================
   5. BATTLE COMPONENTS - LEFT/RIGHT/LOG
   ========================================= */
/* Party List */
.party-unit { border-bottom: 1px solid #333; margin-bottom: 5px; background: rgba(30,30,35,0.5); transition: background 0.2s; cursor: pointer; }
.party-unit:hover { background: rgba(50,50,60,0.8); }
.party-unit.active-turn { border-left: 3px solid gold; background: rgba(50,40,10,0.8); }
.party-unit.viewing { border: 1px solid #5588cc; }

/* Log */
#log-box { flex: 1; overflow-y: auto; font-size: 12px; background: #0a0a0a; transition: opacity 0.3s ease; }
#log-content { padding: 5px; display: flex; flex-direction: column; gap: 2px; }
.log-entry { padding: 3px 5px; border-radius: 2px; line-height: 1.4; border-left: 2px solid transparent; }
.log-entry.log-turn { background: #1a1a25; border-left-color: #48f; color: #8af; font-weight: bold; margin-top: 5px; }
.log-entry.log-dmg { color: #fba; }
.log-entry.log-heal { color: #8f8; }
.log-entry.log-cc { color: #f8f; background: rgba(255,0,255,0.05); }
.log-entry.log-skill { color: gold; }
.log-entry.log-system { color: #888; font-style: italic; }

/* =========================================
   6. BATTLE COMPONENTS - BOTTOM PANEL
   ========================================= */
/* Common Column Style */
.bp-col { padding:8px; border-right:1px solid #333; display:flex; flex-direction:column; overflow-y:auto; scrollbar-width:thin; }
.bp-header { font-size:11px; font-weight:bold; color:#eba; border-bottom:1px solid #444; margin-bottom:5px; padding-bottom:2px; font-family: var(--font-game); letter-spacing: 1px; }

/* [ÌôïÏù∏] Í∏∞Ï¥à Ïä§ÌÉØ Ìå®ÎÑê (.col-base) Ï°¥Ïû¨Ìï® */
.col-profile { width: 140px; align-items:center; background:#1a1a1a; flex-shrink: 0; }
.col-base { width: 160px; background:#181818; flex-shrink: 0; } 
.col-combat { width: 180px; background:#1a1a1a; flex-shrink: 0; }
.col-status { flex: 1; background:#151515; }

/* Portrait & Level */
.portrait-lg { font-size:40px; background:#222; border-radius:50%; width:60px; height:60px; display:flex; align-items:center; justify-content:center; border:2px solid #666; margin-bottom:5px; }
.basic-name { font-weight:bold; color:gold; font-size:14px; margin-bottom:2px; }
.basic-lv { font-size:11px; color:#aaa; margin-bottom:5px; }

/* Stat Rows (Basic Stats, Combat Stats) */
.stat-row { display:flex; align-items:center; justify-content: space-between; font-size:11px; margin-bottom:2px; height:18px; }
.stat-label { color:#999; cursor:help; font-family: var(--font-main); }
.stat-val-box { display:flex; align-items:center; gap:4px; }
.stat-val { font-weight:bold; color:#eee; font-family: var(--font-game); min-width: 25px; text-align: right; }
.stat-arrow { font-size:10px; color:#5f5; font-weight:bold; width: 10px; text-align: center; }
.val-buff { color:#5f5 !important; }
.val-debuff { color:#f55 !important; }
.val-base { color:#aaa; }

.stat-up-btn { background: #28a745; border: 1px solid #1e7e34; color: white; border-radius: 3px; width: 14px; height: 14px; font-size: 10px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
.stat-up-btn:hover { background: #218838; transform: scale(1.1); }
.stat-up-btn.disabled { background:#444; border-color:#555; color:#888; cursor:not-allowed; }

/* HP/MP Bars */
.bar-container { background:#111; border-radius:3px; overflow:hidden; width:100%; margin-top:2px; position:relative; }
.bar-fill { height:100%; transition:width 0.3s; }
.hp-fill { background:#d33; } .mp-fill { background:#0ae; } .xp-fill { background:#ccc; } 
.bar-text { font-size:10px; color:#fff; text-align:center; position:absolute; top:50%; transform: translateY(-50%); width:100%; text-shadow:1px 1px 0 #000; line-height:1; font-weight: bold; }

/* Status Details */
.status-list { flex:1; display:flex; flex-direction:column; gap:4px; overflow-y:auto; }
.status-detail-item { display: flex; align-items: center; gap: 10px; background: rgba(255, 255, 255, 0.05); border: 1px solid #444; padding: 8px; margin-bottom: 6px; border-radius: 6px; width: 100%; }
.status-detail-item.passive { border-color: #443; background: rgba(255, 215, 0, 0.05); }
.status-icon-box { font-size: 22px; min-width: 30px; text-align: center; }
.status-info-box { flex: 1; display: flex; flex-direction: column; gap: 2px; }
.st-name { font-size: 12px; font-weight: bold; color: gold; }
.st-turn { color: #ff6666; font-size: 10px; margin-left: 5px; }
.st-desc { font-size: 10px; color: #bbb; line-height: 1.3; }

/* =========================================
   7. SKILL PANEL (INTEGRATED LAYOUT)
   ========================================= */
/* ÌïòÎã® Ìå®ÎÑê ÎÇ¥Î∂Ä Ïä§ÌÇ¨ Ïª¨Îüº */
.col-skills {
    flex: 1.5; 
    display: flex; flex-direction: column;
    background: #111; border-right: 1px solid #333;
    min-width: 220px;
}

/* Ïä§ÌÇ¨ Î™©Î°ù Í∑∏Î¶¨Îìú */
.skill-grid-container {
    flex: 1; display: grid;
    grid-template-columns: repeat(auto-fill, minmax(55px, 1fr)); 
    grid-auto-rows: 55px; gap: 5px;
    padding: 8px; overflow-y: auto;
    scrollbar-width: thin; scrollbar-color: #888 #222;
}

/* Ïä§ÌÇ¨ Î≤ÑÌäº */
.skill-btn { 
    background: linear-gradient(to bottom, #2a2a2a, #1a1a1a); 
    border: 1px solid #444; border-radius: 4px; color: #ccc; 
    display: flex; flex-direction: column; align-items: center; justify-content: center; 
    cursor: pointer; position: relative; transition: 0.1s;
    width: 100%; height: 100%; 
}
.skill-btn:hover { border-color: #888; background: #333; }
.skill-btn.active { border-color: gold; box-shadow: 0 0 5px rgba(255,215,0,0.5); background: #332; }

/* Ïû†Í∏à & ÎßàÎÇò Î∂ÄÏ°± */
.skill-btn.locked { opacity: 0.4; filter: grayscale(100%); cursor: not-allowed; background: #0f0f0f; border-style: dashed; color: #555; }
.skill-btn.locked:hover { border-color: #444; background: #0f0f0f; }
.skill-btn.mana-lack { opacity: 0.8; background: #2a1010; border-color: #522; }
.skill-btn.mana-lack .skill-icon { color: #f55; }

.skill-icon { font-size: 20px; margin-bottom: 2px; }
.skill-name { font-size: 9px; text-align: center; width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; line-height: 1.1; }
.skill-cost { font-size: 8px; color: #0af; position: absolute; top: 2px; right: 2px; text-shadow: 1px 1px 0 #000; }

/* ÌïòÎã® Ìë∏ÌÑ∞ (Ìè¨ÏÖò + ÌÑ¥Ï¢ÖÎ£å) */
.skill-footer {
    height: 50px;
    display: flex;
    justify-content: space-between; /* ÏñëÎÅù Ï†ïÎ†¨ */
    align-items: center;
    gap: 10px;
    padding: 5px 10px;
    border-top: 1px solid #333;
    background: #151515;
}

/* ÏÜåÎπÑ ÏïÑÏù¥ÌÖú 5Ïπ∏ Ïª®ÌÖåÏù¥ÎÑà */
.consumable-grid {
    display: flex;
    gap: 4px;
}

/* Í∞úÎ≥Ñ Ïä¨Î°Ø (ÌÅ¨Í∏∞ Ï°∞Ï†ï) */
.potion-slot {
    width: 36px; 
    height: 36px;
    background: #1a1a1a; 
    border: 1px solid #444; 
    border-radius: 4px;
    display: flex; 
    align-items: center; 
    justify-content: center;
    font-size: 18px; 
    cursor: pointer; 
    color: #fff;
    position: relative; 
    transition: all 0.2s;
}
.potion-slot.filled:hover { border-color: #fff; background: #252525; }
.potion-slot.empty { opacity: 0.2; border-style: dashed; cursor: default; }

/* [ÏàòÏ†ï] ÌÑ¥ Ï¢ÖÎ£å Î≤ÑÌäº (ÏûëÍ≤å Ï∂ïÏÜå) */
.turn-btn { 
    width: 80px; /* Í≥†Ï†ï ÎÑàÎπÑ (ÏûëÍ≤å) */
    height: 36px; 
    background: linear-gradient(180deg, #522, #311); 
    color: #eaa; 
    border: 1px solid #733; 
    border-radius: 4px; 
    cursor: pointer; 
    font-weight: bold; 
    font-size: 11px; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    transition: 0.2s;
    flex-shrink: 0; /* Ï∞åÍ∑∏Îü¨Ïßê Î∞©ÏßÄ */
}
.turn-btn:hover { background: linear-gradient(180deg, #733, #522); border-color: #f88; color: #fff; }

/* =========================================
   8. FLOATING CONTROLS (HEADS-UP)
   ========================================= */
#floating-controls {
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    gap: 4px;
    position: fixed; 
    z-index: 9999; 
    /* transform: translate(-50%, -100%);*/
    transition: opacity 0.2s; 
    opacity: 1; 
    pointer-events: auto;
}

/* Ìà¨Î™ÖÎèÑ ÌÅ¥ÎûòÏä§ (HÌÇ§Ïö©) */
.hud-hidden { 
    opacity: 0 !important; 
    pointer-events: none !important; 
}

.hud-guide-text {
    font-size: 10px; 
    font-weight: bold; 
    color: rgba(255, 255, 255, 0.8);
    background: rgba(0, 0, 0, 0.6); 
    padding: 2px 6px; 
    border-radius: 4px;
    white-space: nowrap; 
    pointer-events: none;
}

/* Î≤ÑÌäº Í∑∏Î£π (Í∞ÄÎ°ú ÏùºÏûê Î∞∞Ïπò) */
.float-btn-group {
    display: flex; 
    flex-direction: row; /* Í∞ÄÎ°ú Ï†ïÎ†¨ Í∞ïÏ†ú */
    align-items: center; 
    gap: 8px; 
    padding: 6px 12px;
    background: linear-gradient(180deg, rgba(30, 30, 40, 0.95), rgba(10, 10, 15, 0.98)); 
    border: 1px solid #556; 
    border-radius: 30px; 
    position: relative;
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
}

.float-btn-group::after {
    content: ''; 
    position: absolute; 
    bottom: -6px; 
    left: 50%; 
    transform: translateX(-50%);
    border-width: 6px 6px 0; 
    border-style: solid; 
    border-color: rgba(10, 10, 15, 0.98) transparent transparent transparent;
}
.float-btn {
    width: 36px; height: 36px; border-radius: 50%; border: 1px solid #556;
    background: linear-gradient(135deg, #334, #223); color: #ddd; font-size: 18px;
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    transition: all 0.2s; position: relative; overflow: hidden;
}
.float-btn:hover { transform: translateY(-2px) scale(1.1); background: linear-gradient(135deg, #445, #334); border-color: gold; color: gold; box-shadow: 0 0 8px rgba(255, 215, 0, 0.3); }
.float-btn.action { box-shadow: inset 0 0 10px rgba(0,0,0,0.5); }
.float-btn.end { background: linear-gradient(135deg, #522, #311); border-color: #744; }
.float-btn.end:hover { background: linear-gradient(135deg, #733, #522); border-color: #f55; color: #fff; box-shadow: 0 0 8px rgba(255, 50, 50, 0.5); }
.float-btn.confirm { background: #252; border-color:#484; color:#bfb; }
.float-btn.confirm:hover { background: #373; box-shadow: 0 0 10px #4f4; }
.float-btn.cancel { background: #522; border-color:#844; color:#fbb; }
.float-btn.cancel:hover { background: #733; box-shadow: 0 0 10px #f44; }
.float-btn.disabled { filter: grayscale(100%); opacity: 0.5; cursor: not-allowed; border-color: #333; }

/* =========================================
   9. POPUPS, MODALS, OVERLAYS
   ========================================= */
.tooltip-box { 
    position:fixed; background:rgba(15,15,20,0.98); border:1px solid gold; padding:10px; color:white; border-radius:6px; 
    font-size:12px; pointer-events:none; z-index:2000; display:none; box-shadow:0 5px 15px rgba(0,0,0,0.8); max-width:280px; word-wrap: break-word;
}
.item-tooltip {
    position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%);
    background: rgba(0,0,0,0.9); border: 1px solid #aaa; color: #fff; padding: 5px 10px;
    border-radius: 4px; font-size: 12px; white-space: nowrap; z-index: 200;
    pointer-events: none; display: none;
}
.potion-slot:hover .item-tooltip { display: block; }

.floating-text { position:absolute; font-weight:bold; font-size:20px; pointer-events:none; z-index:500; text-shadow:2px 2px 0 #000; animation:floatUp 1.0s forwards; white-space: nowrap; transform: translate(-50%, -50%);}
@keyframes floatUp { 0% { transform:translateY(0); opacity:1; } 100% { transform:translateY(-40px); opacity:0; } }
.speech-bubble { position: absolute; background: white; color: black; padding: 4px 10px; border-radius: 12px; font-weight: bold; font-size: 12px; transform: translate(-50%, -100%); pointer-events: none; z-index: 600; white-space: nowrap; box-shadow: 0 2px 5px rgba(0,0,0,0.5); }
.speech-bubble::after { content: ''; position: absolute; bottom: -5px; left: 50%; transform: translateX(-50%); border-width: 5px 5px 0; border-style: solid; border-color: white transparent transparent transparent; }
.unit-overlay { position: absolute; transform: translate(-50%, -50%); pointer-events: none; }

.modal { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:100; display:none; align-items:center; justify-content:center; }
.modal-content { background:#1a1a1a; border:2px solid gold; padding:30px; text-align:center; border-radius:10px; min-width:300px; }
.modal-btns button { margin:10px; padding:10px 20px; font-size:16px; cursor:pointer; background:#333; color:white; border:1px solid #666; font-family: var(--font-game); }
.modal-btns button:hover { background:#555; }

.modal-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:9999; display:flex; align-items:center; justify-content:center; }
.system-modal-box { background:#222; border:2px solid #666; padding:20px; border-radius:8px; min-width:300px; text-align:center; box-shadow:0 10px 30px rgba(0,0,0,0.8); }
.sys-msg { font-size:16px; color:#eee; margin-bottom:20px; white-space:pre-wrap; }
.sys-btns { display:flex; justify-content:center; gap:10px; }
.sys-btn { padding:8px 20px; background:#444; border:1px solid #666; color:white; cursor:pointer; border-radius:4px; font-weight:bold; }
.sys-btn:hover { background:#555; border-color:#888; }
.sys-btn.confirm { background:#252; border-color:#474; }

.cooldown-overlay { position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); display:flex; align-items:center; justify-content:center; font-size:24px; font-weight:bold; color:#fff; z-index:5; }
.confirm-overlay { position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:10; display:flex; flex-direction:column; justify-content:center; align-items:center; gap:3px; }
.confirm-btn { width:80%; font-size:11px; padding:4px; border-radius:3px; cursor:pointer; background:#252; color:#bfb; border:1px solid #484; font-weight:bold; }
.cancel-btn { width:80%; font-size:11px; padding:4px; border-radius:3px; cursor:pointer; background:#522; color:#fbb; border:1px solid #744; font-weight:bold; }
.confirm-btn:hover { background:#363; }
.cancel-btn:hover { background:#733; }

/* =========================================
   10. MANAGEMENT & PREP UI
   ========================================= */
.manage-container { display: grid; grid-template-columns: 220px 360px 460px; gap: 15px; height: 85vh; padding: 10px; width: 100%; max-width: 1400px; }
.col-header { font-family: var(--font-game); background: linear-gradient(90deg, #333, #111); color: gold; text-align: left; padding: 10px 15px; font-size: 14px; border-bottom: 1px solid #444; }
.col-body { flex:1; padding:15px; overflow-y:auto; scrollbar-width:thin; }

.hero-list-item { display:flex; align-items:center; gap:10px; padding:10px; margin-bottom:8px; background:#1a1a1a; border:1px solid #333; border-radius:6px; cursor:pointer; transition:all 0.2s; position: relative; }
.hero-list-item:hover { background:#252525; border-color:#666; }
.hero-list-item.selected { background:linear-gradient(90deg, #2a2a2a, #222); border-color:gold; box-shadow:inset 3px 0 0 gold; }
.list-icon { font-size:24px; width:36px; height:36px; background:#111; border-radius:50%; display:flex; align-items:center; justify-content:center; border:1px solid #444; }
.list-info h4 { margin:0; font-size:13px; color:#ddd; }
.list-info span { font-size:11px; color:#888; }

.manage-bar-group { width: 100%; margin-bottom: 15px; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 4px; }
.manage-bar-row { display: flex; align-items: center; gap: 10px; margin-bottom: 4px; font-size: 11px; color: #ccc; }
.m-bar-bg { flex: 1; height: 8px; background: #222; border-radius: 2px; overflow: hidden; position: relative; }

.equipment-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; align-content: start; }
.equip-slot-modern { height: 60px; background: #111; border: 1px solid #444; border-radius: 6px; display: flex; align-items: center; padding: 5px; gap: 10px; cursor: pointer; transition: 0.2s; }
.equip-slot-modern:hover { border-color:#888; background:#151515; }
.equip-slot-modern.filled { border:1px solid #654; background:linear-gradient(135deg, #222, #1a1a1a); }
.slot-bg-icon { width:40px; height:40px; border-radius:4px; display:flex; align-items:center; justify-content:center; font-size:20px; color:#333; opacity: 0.3; filter: grayscale(100%); }
.filled .slot-bg-icon { border: 1px solid gold; background: #000; color:#fff; opacity: 1; filter: none; }
.slot-info { flex:1; display:flex; flex-direction:column; overflow:hidden; }
.slot-name { font-size:12px; font-weight:bold; color:#555; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.filled .slot-name { color:gold; }
.slot-placeholder { font-size:10px; color:#444; }

.stat-panel-container { display: flex; gap: 10px; align-items: stretch; width: 100%; }
.stat-panel { background: rgba(0,0,0,0.2); border-radius: 6px; border: 1px solid #444; flex: 1; min-width: 200px; }
.stat-sub-header { font-family: var(--font-game); font-size: 11px; letter-spacing: 1px; color: #888; background: #222; height: 32px; display: flex; align-items: center; justify-content: center; border-bottom: 1px solid #333; }
.stat-box { display: flex; align-items: center; justify-content: space-between; height: 28px; padding: 0 8px; }
.stat-value-group { display: flex; align-items: center; justify-content: flex-end; gap: 4px; white-space: nowrap; flex-wrap: nowrap; min-width: 85px; }
.stat-label-group { display: flex; align-items: center; justify-content: flex-end; gap: 8px; min-width: 80px; }
.stat-key { font-family: var(--font-main); font-size: 11px; font-weight: 700; color: #aaa; letter-spacing: -0.5px; }
.stat-value-num { font-family: var(--font-game); font-size: 13px; color: #eee; text-align: right; }
.stat-bonus { color: #5f5; font-size: 10px; margin-left: 5px; }

.arrow-high { color: #0f0; font-weight: 900; font-size: 13px; text-shadow: 0 0 8px rgba(0, 255, 0, 0.8); vertical-align: middle; letter-spacing: -5px; }
.arrow-mid { color: #3c3; font-weight: bold; }
.arrow-low { color: #fc0; font-weight: normal; }

.mini-inven-grid { display: grid; grid-template-columns: repeat(5, 54px); grid-auto-rows: 54px; gap: 8px; padding: 12px; justify-content: center; background: #0a0a0a; border: 1px solid #333; border-radius: 6px; }
.mini-item { width: 54px; height: 54px; background: #111; border: 1px solid #444; border-radius: 4px; display: flex; align-items: center; justify-content: center; position: relative; cursor: pointer; }
.mini-item:hover { border-color: gold; background: #252525; }
.mini-item .item-icon { font-size: 34px; line-height: 1; }
.mini-btn { position: absolute; bottom: 2px; right: 2px; font-size: 9px; padding: 1px 4px; background: #252; color: #bfb; border: none; border-radius: 2px; cursor: pointer; }

.dismiss-btn { width:100%; padding:8px; background:#311; border:1px solid #522; color:#d88; cursor:pointer; border-radius:4px; font-size:11px; }
.dismiss-btn:hover { background:#522; color:white; }

.game-card { background:#222; border:1px solid #444; border-radius:8px; padding:15px; display:flex; flex-direction:column; align-items:center; text-align:center; transition: 0.2s; }
.game-card:hover { transform: translateY(-5px); border-color: #666; }
.game-card.sold-out { opacity:0.5; filter:grayscale(100%); pointer-events:none; position: relative; }
.game-card.sold-out::after { content:"SOLD OUT"; position:absolute; top:50%; left:50%; transform:translate(-50%, -50%) rotate(-15deg); color:#f44; font-weight:bold; font-size:24px; border:2px solid #f44; padding:5px 10px; text-shadow:2px 2px 0 black; z-index: 5; }
.card-big-icon { font-size: 60px; margin-bottom: 10px; }
.item-btn { margin-top:5px; padding:6px; border:1px solid #555; background:#333; color:#ddd; cursor:pointer; border-radius:4px; width:100%; }
.item-btn.buy { background:#252; border-color:#474; color:#bfb; }
.hire-btn { width:100%; padding:10px; background:#262; color:#bfb; border:1px solid #484; border-radius:4px; cursor:pointer; font-weight:bold; margin-top: auto; }
.hire-btn:hover { background:#383; }
.hire-btn:disabled { background:#333; color:#555; border-color:#444; cursor:not-allowed; }

.sidebar-footer { padding: 10px; border-top: 1px solid #444; background: #111; margin-top: auto; }
.auto-btn-sidebar { width: 100%; height: 38px; background: #2a2a2a; color: #888; border: 1px solid #555; border-radius: 4px; cursor: pointer; font-weight: bold; display: flex; align-items: center; justify-content: center; gap: 8px; transition: 0.2s; }
.auto-btn-sidebar.active { background: #432; border-color: gold; color: gold; }
.lv-up-inner-btn { background: gold; color: black; border: none; border-radius: 4px; padding: 2px 6px; font-size: 10px; font-weight: bold; cursor: pointer; box-shadow: 0 0 5px rgba(255, 215, 0, 0.5); }

.prep-header { width:100%; height:50px; display:flex; justify-content:space-between; align-items:center; padding:0 20px; border-bottom:1px solid #444; background:#111; z-index: 10; }
.prep-container { flex:1; display:flex; flex-direction:column; width:100%; max-width:1600px; padding:10px; gap:10px; overflow:hidden; margin: 0 auto; position: relative; }
.prep-top-row { display: flex; flex: 1; gap: 10px; overflow: hidden; min-height: 0; }
.prep-panel { background:#151515; border:1px solid #333; border-radius:8px; display:flex; flex-direction:column; overflow:hidden; position:relative; }
.prep-col-left { width: 220px; display: flex; flex-direction: column; }
.deployed-list { flex:1; overflow-y:auto; padding:10px; display:flex; flex-direction:column; gap:8px; }
.deployed-card { display: flex; align-items: center; gap: 10px; background: #222; border: 1px solid #444; padding: 8px; border-radius: 4px; cursor: pointer; transition: 0.2s; position: relative; }
.deployed-card:hover { background: #2a2a2a; border-color: #666; }
.deployed-card.active-leader { border: 1px solid gold; background: linear-gradient(90deg, #332a00, #222); }
.leader-crown-icon { margin-left: auto; font-size: 16px; filter: grayscale(100%) opacity(0.2); transition: 0.2s; }
.deployed-card.active-leader .leader-crown-icon { filter: none; opacity: 1; transform: scale(1.2); }
.prep-col-center { flex: 1; display: flex; flex-direction: column; background: #050505; border: 2px solid #555; }
.prep-map-wrapper { flex: 1; position: relative; overflow: hidden; display: flex; justify-content: center; align-items: center; background: #1a1a1a; box-shadow: inset 0 0 50px rgba(0,0,0,0.5); }
.minimap-grid-layer { position: absolute; width: 880px; height: 480px; transform: scale(0.95); transform-origin: center center; }
.hex-tile { position: absolute; width: 40px; height: 44px; z-index: 1; clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%); display: flex; justify-content: center; align-items: center; font-size: 10px; transition: 0.2s; }
.hex-tile.zone-ally { background-color: #2f3b4a; border: 1px solid rgba(100, 150, 255, 0.1); }
.hex-tile.zone-ally::before { content:''; position:absolute; inset:1px; background:#1a2a3a; clip-path:inherit; z-index:-1; }
.hex-tile.zone-ally:hover { background-color: #4a8aff; cursor: pointer; }
.hex-tile.zone-enemy { background-color: #4a2f2f; opacity: 0.6; }
.hex-tile.zone-enemy::before { content:''; position:absolute; inset:1px; background:#1a1111; clip-path:inherit; z-index:-1; }
.hex-tile.drag-valid { background-color: gold !important; z-index: 5; }
.hex-unit { position: absolute; width: 36px; height: 40px; z-index: 10; pointer-events: auto; clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%); display: flex; justify-content: center; align-items: center; font-size: 20px; cursor: grab; filter: drop-shadow(0 0 3px black); transition: 0.2s; }
.hex-unit:active { cursor: grabbing; transform: scale(0.9); }
.hex-unit.hero { background: linear-gradient(135deg, #4488ff, #112266); color: white; border: 1px solid #8af; }
.hex-unit.hero:hover { z-index: 20; transform: scale(1.1); box-shadow: 0 0 15px white; }
.hex-unit.hero.is-leader::before { content: "üëë"; position: absolute; top: 0; right: 0; font-size: 14px; z-index: 30; filter: drop-shadow(0 0 2px black); }
.hex-unit.enemy { background: linear-gradient(135deg, #ff4444, #661111); color: #fcc; pointer-events: none; }
.prep-col-right { width: 220px; display: flex; flex-direction: column; }
.enemy-list { flex:1; overflow-y:auto; padding:10px; display:flex; flex-direction:column; gap:8px; }
.enemy-card-mini { display: flex; align-items: center; gap:10px; background: #2a1111; border: 1px solid #522; padding: 5px 10px; border-radius: 4px; }
.prep-bottom-row { height: 130px; display: flex; flex-direction: column; }
.roster-scroll-area { flex: 1; display: flex; align-items: center; gap: 10px; overflow-x: auto; overflow-y: hidden; padding: 10px 20px; background: #111; border-top: 1px solid #333; white-space: nowrap; }
.roster-card-h { min-width: 100px; height: 90px; background: #222; border: 1px solid #444; border-radius: 6px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: grab; transition: 0.2s; flex-shrink: 0; position: relative; }
.roster-card-h:hover { background: #333; border-color: gold; transform: translateY(-5px); }
.roster-card-h.deployed { opacity: 0.4; filter: grayscale(100%); background: #111; border-color: #333; pointer-events: none; cursor: default; transform: none !important; }
.roster-card-h.deployed::after { content: "DEPLOYED"; position: absolute; font-size: 10px; font-weight: bold; color: #888; border: 1px solid #444; padding: 2px; transform: rotate(-15deg); }
.prep-footer { height:50px; display:flex; justify-content:center; align-items:center; gap:20px; background:#080808; border-top:1px solid #333; }
.prep-btn { padding:8px 25px; font-size:14px; font-family: var(--font-game); cursor:pointer; border-radius:4px; font-weight:bold; border:1px solid #444; background:#333; color:#ddd; }
.prep-btn:hover { background:#444; }
.prep-btn.start { background:#252; color:#bfb; border-color:#484; font-size:16px; padding:8px 50px; }
.prep-btn.start:hover { background:#363; transform: scale(1.05); }
.prep-btn.auto { background:#335; color:#adf; border-color:#448; }
/* =========================================
   [Ïã†Í∑ú] ÏïÑÏù¥ÌÖú ÏÇ¨Ïö© ÌôïÏù∏ ÌåùÏóÖ (Ïä¨Î°Ø Î∞îÎ°ú ÏúÑ)
   ========================================= */
.item-confirm-popup {
    position: absolute;
    bottom: 110%; /* Ïä¨Î°Ø Î∞îÎ°ú ÏúÑ */
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 5px;
    background: rgba(0, 0, 0, 0.8);
    padding: 4px;
    border-radius: 4px;
    border: 1px solid #555;
    z-index: 200;
}

.confirm-mini-btn {
    width: 24px; height: 24px;
    border-radius: 4px;
    border: 1px solid #fff;
    cursor: pointer;
    font-weight: bold;
    font-size: 14px;
    display: flex; align-items: center; justify-content: center;
}
.confirm-mini-btn.ok { background: #262; color: #bfb; border-color: #484; }
.confirm-mini-btn.ok:hover { background: #383; }
.confirm-mini-btn.no { background: #522; color: #fbb; border-color: #844; }
.confirm-mini-btn.no:hover { background: #733; }

/* Í∏∞Ï°¥ Ìè¨ÏÖò Ïä¨Î°Ø Ïä§ÌÉÄÏùº Î≥¥ÏôÑ */
.potion-slot {
    position: relative; /* ÌåùÏóÖ ÏúÑÏπò Í∏∞Ï§Ä */
}
/* ÏÑ†ÌÉùÎêú ÏïÑÏù¥ÌÖú Ïä¨Î°Ø Í∞ïÏ°∞ */
.potion-slot.confirming {
    border-color: gold;
    box-shadow: 0 0 5px gold;
}